You are coding an e-commerce web app for 360 Logistics using Next.js 14 (App Router), TypeScript, styled-components, and Supabase.

UPDATED SCOPE:

- Admin panel IS included.
- Variations are mandatory for purchasing (cart & orders operate on variation_id).

HARD RULES:

- Products are base entities. Variations (types/flavors/sizes) belong to a product and are not separate products.
- Cart and orders must operate on VARIATION LEVEL (variation_id), not product level.
- Checkout is allowed only for authenticated users (Supabase Auth).
- Orders must be saved to Supabase and emailed (no online payment).
- Do not implement any payment provider.

DATA RULES (Supabase):

- Use tables: categories, products, product_variations, orders, order_items, (optional user_profiles).
- Product detail page must fetch product + ACTIVE variations.
- If product has only 1 active variation: auto-select and hide variation chooser.
- If product has >1 active variations: require user selection before add-to-cart.

VARIATION TRUTH RULES (IMPORTANT):

- Every variation has its own price and its own image.
- Use variation.price as the displayed and charged price.
- Use variation.image_url as the displayed image.
- Product image (products.image_url) may exist only as optional fallback:
  - displayImage = variation.image_url ?? product.image_url
  - but the expectation is that variation.image_url is present for all purchasable variations.

UI RULES:

- Product listing shows product once (no duplication for variations).
- Product details show:
  - image: selectedVariation.image_url (fallback to product.image_url only if needed)
  - price: selectedVariation.price
- Cart item uses:
  - variationId, variationName, variation.price
  - image: selectedVariation.image_url (fallback only if needed)

ADMIN PANEL RULES:

- Provide an admin area to manage catalog and orders:
  - Categories CRUD (incl. parent_id for subcategories)
  - Products CRUD (base product data)
  - Product Variations CRUD (price + image per variation; activate/deactivate)
  - Orders list + order details (read-only or status updates depending on requirements)
- Admin must be protected:
  - Only authorized users can access admin routes (use Supabase auth + role/claim or allowlist).
- Admin features must not leak to public routes.

ENGINEERING RULES:

- Prefer clean components and predictable folder structure.
- Use environment variables for Supabase keys and email settings.
- Keep UI minimal and white-based; no Tailwind.
- Implement SR/EN translations and hreflang; SEO basics: meta, sitemap, robots, schema.org/Product.
- Provide code that is production-ready, typed, and easy to maintain.

When uncertain, follow the README/spec and document assumptions in code comments.
